<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Óscar martínez Bañales">
    <meta name="copyright" content="Óscar martínez Bañales">
    <meta name="description" content="Página de programación en Java"/>
    <meta name="keywords" content="java, spring, spring mvc, spring boot, groovy">
    <!-- google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Chilanka&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">
    <!-- jQuery JS --> 
    <script src="../js/jquery.min.js"></script>
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/highlight/styles/atom-one-light.css">
    <link rel="stylesheet" type="text/css" href="../css/mystyle.css">
    <title>CodigoJava - springboot2 - thymeleaf</title>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#"><img src="../images/title.png"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="../index.html">home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../contact.html">contact</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://es.stackoverflow.com/users/110116/oscar?tab=profile">about</a>
          </li>
        </ul>
      </div>
    </nav>
    <!-- Page Header -->
    <header class="masthead">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <div class="site-heading">
              <img class="img-fluid" src="../images/logo.png">
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- Main Content -->
    <div class="container">
      <div class="row">
        <div class="col-lg-10 col-md-12 mx-auto">
          <h2 class="sub-title bg-danger text-white" align="center">Spring Boot 2 - Thymeleaf - Layout</h2>
          <p>Descarga el <a href="https://github.com/wanchopi/springboot2-thymeleaf-layout">proyecto de GitHub</a>.</p>
          <h4 class="sub-title bg-secondary text-white">Introducción</h4>
          <p>Partimos del proyecto anterior y lo vamos a mejorar con <strong>Thymeleaf Layout Dialect</strong>. <a href="https://www.thymeleaf.org/doc/articles/layouts.html" target="_blank">Aquí la pagina oficial</a>.</p>
          <p>Entonces lo único que va a cambiar respecto al proyecto anterior es el <strong>Front-End</strong>. Para ello necesitamos añadir al proyecto la dependencia <mark>thymeleaf-layout-dialect</mark>.</p>
          <p>También veremos los <strong>Webjars</strong>, que son una serie de bibliotecas del lado del cliente empaquetadas en archivos jar. Por ejemplo la biblioteca jQuery o  Bootstrap.</p>
          <p>El principal problema que WebJars resuelve es hacer que las dependencias del lado del cliente estén disponibles en Maven Central y sean utilizables en cualquier proyecto estándar de Maven.</p>
          <p>Finalizaremos con una pequeña explicación de la herramienta <strong>DevTools</strong>.</p>
          <h4 class="sub-title bg-secondary text-white">El proyecto</h4>  
          <p>Partimos pues del <a href="springboot2-thymeleaf.html">proyecto anterior</a> y añadimos las dependencias nuevas que nos hacen falta.</p>
          <h5>Las dependencias</h5>
          <h6 class="text-info">pom.xml</h6>
          <div class="col-lg-12 mycode">
            <pre><code class="XML">
&lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;nz.net.ultraq.thymeleaf&lt;/groupId&gt;
      &lt;artifactId&gt;thymeleaf-layout-dialect&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
      &lt;scope&gt;runtime&lt;/scope&gt;
      &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
      &lt;scope&gt;test&lt;/scope&gt;
      &lt;exclusions&gt;
        &lt;exclusion&gt;
          &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;
          &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;
        &lt;/exclusion&gt;
      &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
          &lt;groupId&gt;org.webjars&lt;/groupId&gt;
          &lt;artifactId&gt;bootstrap&lt;/artifactId&gt;
          &lt;version&gt;4.1.0&lt;/version&gt;
       &lt;/dependency&gt;
     &lt;dependency&gt;
       &lt;groupId&gt;org.webjars&lt;/groupId&gt;
        &lt;artifactId&gt;jquery&lt;/artifactId&gt;
        &lt;version&gt;3.4.1&lt;/version&gt;
     &lt;/dependency&gt;
  &lt;/dependencies&gt;   
            </code></pre>
          </div>
          <h5>La Configuración</h5>
          <p>Ver la del <a href="springboot2-thymeleaf.html#config">proyecto anterior</a></p>
          <h5>El Controlador</h5>
          <p>Ver el del <a href="springboot2-thymeleaf.html#controller">proyecto anterior</a></p>
          <h5>Testing</h5>
          <p>Ver el del <a href="springboot2-thymeleaf.html#testing">proyecto anterior</a></p>
          <h5>Las vistas</h5>
          <p>Vamos a ver la estructura del proyecto centrandonos en la vista:</p>
          <img src="../images/springboot2-thymeleaf-layout.png" alt="estructura">
          <p>Destacamos dos cosas; la desaparición de <strong>jquery</strong> y <strong>bootstrap</strong>. Como decía en la introducción, los tenemos como archivos jar.</p>
          <p>Por otro lado, dentro de la carpeta templates aparte del <mark>index.html</mark> tenemos dos nuevas carpetas, layouts con un archivo <mark>layout.html</mark> y fragments con dos archivos, <mark>header.html</mark> y <mark>footer.html</mark>.</p>
          <h6 class="text-info">layout.html</h6>
          <div class="col-lg-12 mycode">
            <pre><code class="html">
&lt;!DOCTYPE html&gt;
&lt;html 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;
  &lt;title layout:title-pattern="$DECORATOR_TITLE - $CONTENT_TITLE"&gt;SpringBootThymeleaf&lt;/title&gt;
  &lt;meta
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    name="viewport" /&gt;
  &lt;link rel="stylesheet" type="text/css" href="webjars/bootstrap/4.1.0/css/bootstrap.min.css" /&gt;
  &lt;link rel="stylesheet" type="text/css" href="webjars/jquery/3.4.1/jquery.min.css" /&gt;
  &lt;link rel="stylesheet" type="text/css" th:href="@{/assets/css/main.css}"/&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;!--header.html  that's here  --&gt;
  &lt;header&gt;
    &lt;div th:replace="fragments/header :: header"&gt;&lt;/div&gt;
  &lt;/header&gt;
  
  &lt;div class="container"&gt;

    &lt;div layout:fragment="content"&gt;
      &lt;!-- Your Page Content Here --&gt;
    &lt;/div&gt;

  &lt;/div&gt;

  &lt;!--footer.html  that's here  --&gt;
  &lt;footer&gt;
    &lt;div th:replace="fragments/footer :: footer"&gt;&lt;/div&gt;
  &lt;/footer&gt;

  &lt;!-- JS --&gt;
  &lt;script type="text/javascript" src="/webjars/bootstrap/4.1.0/js/bootstrap.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="/webjars/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;
  &lt;!-- jquery --&gt;
    &lt;script&gt;
    $(document).ready(function() {
      // ..code
    });
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
            </code></pre>
          </div>
          <p>Normalmente los sitios web comparten componentes comunes de la página como el encabezado, el pie de página, el menú y posiblemente muchos más. Estos componentes de la página pueden ser utilizados por los mismos o diferentes diseños.</p>
          <h6 class="text-info">header.html</h6>
          <div class="col-lg-12 mycode">
            <pre><code class="html">
&lt;header th:fragment="header" xmlns:th="http://www.w3.org/1999/xhtml"&gt;
  &lt;!-- Static navbar --&gt;
  &lt;nav class="navbar navbar-expand-lg navbar-light bg-light"&gt;
      &lt;img alt="logo" th:src="@{/assets/images/spring_50x50.png}"&gt;
      &lt;button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"&gt;
        &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
      &lt;/button&gt;
      &lt;div class="collapse navbar-collapse" id="navbarSupportedContent"&gt;
        &lt;ul class="navbar-nav mr-auto"&gt;
            &lt;li class="nav-item active"&gt;
              &lt;a class="nav-link" href="#"&gt;Home &lt;span class="sr-only"&gt;(current)&lt;/span&gt;&lt;/a&gt;
            &lt;/li&gt;
            &lt;li class="nav-item"&gt;
              &lt;a class="nav-link" href="#"&gt;Link&lt;/a&gt;
            &lt;/li&gt;
            &lt;li class="nav-item dropdown"&gt;
              &lt;a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"&gt;
                Dropdown
              &lt;/a&gt;
              &lt;div class="dropdown-menu" aria-labelledby="navbarDropdown"&gt;
                  &lt;a class="dropdown-item" href="#"&gt;Action&lt;/a&gt;
                  &lt;a class="dropdown-item" href="#"&gt;Another action&lt;/a&gt;
                  &lt;div class="dropdown-divider"&gt;&lt;/div&gt;
                  &lt;a class="dropdown-item" href="#"&gt;Something else here&lt;/a&gt;
              &lt;/div&gt;
            &lt;/li&gt;
            &lt;li class="nav-item"&gt;
              &lt;a class="nav-link disabled" href="#"&gt;Disabled&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;form class="form-inline my-2 my-lg-0"&gt;
            &lt;input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search"&gt;
            &lt;button class="btn btn-outline-success my-2 my-sm-0" type="submit"&gt;Search&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
  &lt;/nav&gt;
  &lt;!-- header --&gt;
  &lt;div class="container"&gt;
    &lt;div class="row"&gt;
      &lt;div class="col-lg-12" align="center"&gt;
        &lt;img alt="logo" th:src="@{/assets/images/logo.png}"&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/header&gt;
            </code></pre>
          </div>
          <p>Todas las páginas web de mi sitio (supongamos que esto es un proyecto serio y tiene muchas vistas) comparten la misma cabecera</p>
          <h6 class="text-info">footer.html</h6>
          <div class="col-lg-12 mycode">
            <pre><code class="html">
&lt;div th:fragment="footer" class="footer" xmlns:th="http://www.w3.org/1999/xhtml"&gt;
    &lt;div class="container"&gt;
        &lt;span th:text="#{text.footer}" class="text-muted"&gt;App footer&lt;/span&gt;
    &lt;/div&gt;
&lt;/div&gt;
            </code></pre>
          </div>
          <p>Igual que la cabecera, el pie es compartido por todas mis páginas.</p>
          <h6 class="text-info">index.html</h6>
          <p></p>
          <div class="col-lg-12 mycode">
            <pre><code class="html">
&lt;!DOCTYPE html&gt;
&lt;html 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org" 
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorator="fragments/layout"&gt;
&lt;head&gt;
  &lt;title&gt;index :: spring-thymeleaf&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;!-- body --&gt;
  &lt;div layout:fragment="content"&gt;
    &lt;div class="container-fluid" align="center"&gt;  &lt;!-- main container --&gt;
      &lt;h1 th:text="#{text.title}"&gt;&lt;/h1&gt;
      &lt;p style="margin-top:100px;"&gt;&lt;span th:text="${myModel.now}"&gt;&lt;/span&gt;, &lt;span th:text="${myModel.date}"&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;/div&gt; &lt;!-- /main container --&gt; 
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
            </code></pre>
          </div>
          <p>Declaramos que el index usa el "layout" <mark>layout.html</mark>.</p>
          <h5>Spring Boot DevTools</h5>
          <p>Un problema que tenemos con Spring Boot es que si cambiamos el código fuente el servicio no se actualizará, tendremos que parar el servidor y volverlo a arrancar para que el nuevo código funcione.</p>
          <p>Spring Boot DevTools es la herramienta de Spring Boot que nos permite reiniciar de forma automática nuestras aplicaciones cada vez que se produce un cambio en nuestro código. Por lo que a partir de ahora todos nuestros proyectos con Spring Boot incorporaran esta herramienta.</p>
          <hr>
          <h4 class="sub-title bg-secondary text-white">Herramientas y Software</h4>
          <ul>
            <li>Eclipse Version: 2019-03 (4.11.0)</li>
            <li>Java SE-1.8 (jdk1.8.0)</li>
            <li>Spring Boot 2.2.4</li>
            <li>Spring MVC 5.2.3</li>
            <li>thymeleaf 3.0.11</li>
            <li>thymeleaf-layout-dialect 2.4.1</li>
            <li>bootstrap 4.1.0</li>
            <li>jquery 3.4.1</li>
          </ul>
          <!-- nav -->
          <div class="row" style="margin-left: 20px;">
            <div class="col-lg-6">
              <a href="springboot2-thymeleaf.html"><i class='fas fa-arrow-circle-left'></i> anterior </a>
              <p style="margin-left: 25px; text-decoration: underline;">Spring Boot 2 - Thymeleaf</p>
            </div>
            <div class="col-lg-6">
              <a href="springboot2-data-jpa-thymeleaf.html">siguiente <i class='fas fa-arrow-circle-right'></i></a>
              <p style="text-decoration: underline;">Spring Boot 2 - JPA</p>
            </div>
          </div>
        </div> <!-- /col -->
      </div> <!-- /row -->
    </div> <!-- /container -->
    <hr>
    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <p class="copyright text-muted"><a href="https://github.com/wanchopi" class="my-footer-css">Mis proyectos en github.com</a></p>
            <p class="copyright text-muted">Desarrollado por Óscar Martínez con <a href="https://getbootstrap.com/" class="my-footer-css">Bootstrap</a> y <a href="https://jquery.com/" class="my-footer-css">jQuery</a>
          </div>
        </div>
      </div>
    </footer>
    <!-- Bootstrap JS -->
    <script type="text/javascript" src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/highlight.pack.js"></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>